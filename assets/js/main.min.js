function handle(a,e,i,s,t){this.model=a,this.url=e,this.href=i,this.page=s,this.object_ID=t,this.JSONconfirm=function(i){var s=i||0;s<a.length?"undefined"==typeof JSONobj[a[s]]||JSONobj[a[s]].length<1?$.getJSON(baseURL+"/JSONroute.php",{url:e},function(a){$.each(a,function(a,e){JSONobj[a]=e}),JSONconfirm(s+1)}):JSONconfirm(s+1):render(this.page,this.href)},JSONconfirm()}function render(a,e){switch(a){case"Home":render_home();break;case"Packages":case"Stay":case"Sights":small_cards(e);break;case"About":case"Contact":basic_cards();break;case"packages_details":case"stay_details":large_cards(e)}}function small_cards(a){$("main").html("<div id='small_cards_container'></div>");var e=a.toLowerCase().replace(/\b[a-z]/g,function(a){return a.toUpperCase()});title("div#small_cards_container",e,"alternate"),$.each(JSONobj[model[0]][0],function(e,i){render_small_cards("div#small_cards_container",a,i.ID,i.Image,i.Name,i.Price,i.Overview,i.Duration)})}function render_small_cards(a,e,i,s,t,n,r,c,d){if("rightt"===d)var o="100px";else var o="-100px";$(a).append("<div class='container'><div><a href='"+e+"/"+t+"/"+i+"' data-id='"+i+"' data-req='"+e+"_details'><div><img src='/whatsup/"+s+"'/>"+(void 0==n?"":"<span class='emphasis_small'>From <b>USD "+n+"</b></span>")+"</div><div><span class='emphasis_large'>"+t+"</span><p class='summary'>"+r+"</p><div class='fade'></div></div></a><div><img src='/whatsup/assets/icons/Duration.svg' height='15'/><span class='smallest'>"+c+" days</span><div class='social'><a href=# class='facebook'></a><a href=# class='twitter'></a></div></div></div></div>").children(":last").css("margin-left",o).animate({opacity:"1","margin-left":"0"},700),getSVG("assets/icons/facebook.svg",a+" .social a.facebook"),getSVG("assets/icons/twitter.svg",a+" .social a.twitter")}function large_cards(a){$("main").html("<div id='large_cards_container'></div>");var e=a.split("/")[1].replace(/%20/g," "),e=e.toLowerCase().replace(/\b[a-z]/g,function(a){return a.toUpperCase()});title("div#large_cards_container",e,"alternate"),$.each(JSONobj[model[0]][0],function(e,i){i.ID===object_ID&&render_large_cards("div#large_cards_container",a,i.ID,i.Image,i.Name,i.Price,i.Overview,i.Duration)})}function render_large_cards(a,e,i,s,t,n,r){switch($(a).append("<div class='container'><div><div><img src='"+baseURL+s+"'/></div><div><span class='emphasis_large'>"+t+"</span>"+(void 0==n?"":"<span class='emphasis_medium'>From <b>USD "+n+"</b></span>")+"<p class='summary'>"+r+"</p><div class='fade'><a href=# class='more'>Expand</a></div></div></div></div>").children(".container").fadeIn(),e.split("/")[0]){case"stay":rooms_cards(i);break;case"packages":includes_cards(i)}}function rooms_cards(a){$("main").append("<div id='rooms_cards_container'></div>"),title("div#rooms_cards_container","Rooms","regular"),$.each(JSONobj[model[1]][0],function(e,i){i.ResortID===a&&render_rooms_cards("div#rooms_cards_container",i.Image,i.RoomType,i.Overview)})}function render_rooms_cards(a,e,i,s){$(a).append("<div class='container'><div><div><img src='"+baseURL+e+"'/></div><div><span class='emphasis_large'>"+i+"</span><p class='summary'>"+s+"</p><div class='fade'><a href=# class='more'>Expand</a></div></div></div></div>").children(".container").fadeIn()}function includes_cards(a){$("main").append("<div id='includes_cards_container'></div>"),title("div#includes_cards_container","Includes","regular"),$.each(JSONobj[model[0]][0],function(e,i){i.ID===a&&render_includes_cards("div#includes_cards_container",i.Includes)})}function render_includes_cards(a,e){$(a).append("<div class='container'><div><div class='emphasis_medium'>"+e+"<div class='fade'><a href=# class='more'>Expand</a></div></div></div></div>").children(".container").fadeIn()}function render_home(){$("main").append("<div id='slideshow'><ul id='controls'></ul><ul id='slides'></ul><div>"),$("main").append("<div id='carousel_section' class='carousel_packages'><div id='carousel'></div><ul id='controls'><li><a href=# data-func='next'></a></li><li><a href=# data-func='prev'></a></li></ul><div>"),$("main").append("<div id='customer_quote'><ul id='controls'></ul><div class='quote_container'></div></div>"),getSVG("assets/icons/arrow.svg","div#carousel_section #controls a");new slideshow("div#slideshow",JSONobj.Slideshow[0],9e3,500),new carousel_obj("div#carousel_section",JSONobj.Packages[0],4,"State","Featured","packages");$.each(JSONobj.Quotes[0],function(a,e){state=0==a?"active":"inactive",$("div#customer_quote #controls").append("<li><a href=# data-id='"+e.ID+"' class='"+state+"'></a></li>"),$("div#customer_quote .quote_container").append("<div data-id='"+e.ID+"' class='"+state+"'><p class='emphasis_large'>"+e.Text+"</p><p class='summary'>"+e.Name+"</p></div>")}),$("div#customer_quote").before('<div class="heading_strip"><div class="heading_wrapper"><h3 class="heading">Customer <b>Feedback</b></h3></div></div>'),$("div#carousel_section").before('<div class="heading_strip" style="margin-top:0"><div class="heading_wrapper"><h3 class="heading">Featured <b>Packages</b></h3></div></div>')}function basic_cards(){$("main").html("<div class='basic_cards_container'></div>"),$.each(JSONobj[model[0]][0],function(a,e){title("div.basic_cards_container",e.Title,"alternate"),render_basic_cards(e.Text,"emphasis_small")})}function render_basic_cards(a,e){$("div.basic_cards_container").append('<div class="basic_cards '+e+'">'+a+"</div>")}function getBaseURL(){var a=location.href,e=a.substring(0,a.indexOf("/",14));if(-1!=e.indexOf("http://localhost")){var a=location.href,i=location.pathname,s=a.indexOf(i),t=a.indexOf("/",s+1),n=a.substr(0,t);return n+"/"}return e+"/"}function getSVG(a,e){$.get(baseURL+a,function(a){$(e).html(a)},"text")}function title(a,e,i){$(a).before('<div class="heading_strip '+i+'"><div class="heading_wrapper"><h3 class="heading">'+e+"</b></h3></div></div>")}function mobile_menu(){$(document).on("click","a#menu",function(){$(this).hasClass("active")?($(this).removeClass("active").children("svg").attr("class",""),$("header#small div#header_right, header#small nav#left").css({"margin-left":"100%"})):($(this).addClass("active").children("svg").attr("class","active"),$("header#small div#header_right, header#small nav#left").css({"margin-left":"0"}))}),window.innerWidth<500&&$(document).on("click","nav a",function(){$("a#menu").removeClass("active").children("svg").attr("class",""),$("header#small div#header_right, header#small nav#left").css({"margin-left":"100%"})})}function nav_click(){$(document).on("click","nav a",function(a){$("main").children().fadeOut(function(){$(this).remove()});var e=$(this).attr("href"),i=(e.toLowerCase().replace(/\b[a-z]/g,function(a){return a.toUpperCase()}),$(this).prop("href"));window.history.pushState("","Title",baseURL+e);var s=$(this).attr("data-req");handle(req_models[s],i,e,s,null),a.preventDefault()})}function small_cards_click(){$(document).on("click","div#small_cards_container a",function(a){$("main").children().fadeOut(function(){$(this).remove()});var e=$(this).attr("href"),i=$(this).prop("href");window.history.pushState("","Title",baseURL+e);var s=$(this).attr("data-req");object_ID=$(this).attr("data-id"),handle(req_models[s],i,e,s,object_ID),a.preventDefault()})}function quotes_control(){$(document).on("click","div#customer_quote #controls a",function(a){var e=$("div#customer_quote .quote_container .active"),i=$(this).attr("data-id");$(e).animate({opacity:0},150).removeClass("active"),$("div#customer_quote div[data-id="+i+"]").delay(200).animate({opacity:1},150).addClass("active"),$("div#customer_quote #controls a.active").css({"background-color":"#bfc0c2"}).removeClass("active"),$("div#customer_quote #controls a[data-id="+i+"]").css({"background-color":"#30bec1"}).addClass("active"),a.preventDefault()})}function cards_expand(){$(document).on("click","div#large_cards_container a,div#rooms_cards_container a,div#includes_cards_container a",function(a){"more"===$(this).attr("class")?($(this).parent().parent().closest("div").css({height:"auto"},200),$(this).html("Minimize").attr("class","less"),$(this).parent().css({height:"40px"})):($(this).parent().parent().closest("div").css({height:"200px"},200),$(this).html("Expand").attr("class","more"),$(this).parent().css({height:"70px"})),a.preventDefault()})}function pageLoad(){$("main").children().fadeOut(function(){$(this).remove()});var a=window.location.href,e=a.split(baseURL),i=e[1].split("/");if(i[1]&&""!==i[1]?(s=i[0]+"_details",object_ID=i[2]):s=i[0],s.indexOf("_details")<=-1)var s=s.toLowerCase().replace(/\b[a-z]/g,function(a){return a.toUpperCase()});s||(s="Home"),window.history.pushState("","Title",baseURL+e[1]);var t=s;s.indexOf("_details")>-1?handle(req_models[t],a,e[1],s,object_ID):handle(req_models[t],a,i[0],s,null)}$(document).ready(function(){pageLoad(),mobile_menu(),nav_click(),small_cards_click(),quotes_control(),cards_expand()}),JSONobj={};var baseURL=getBaseURL(),req_models={Home:["Slideshow","Packages","Quotes"],Packages:["Packages"],Stay:["Resorts","Packages"],About:["About"],Contact:["Contact"],stay_details:["Resorts","Rooms"],packages_details:["Packages"]},slideshow=function(a,e,i,s){var t=this,n="",r="";this.container=a,this.slides=e,this.interval=i,this.speed=s,this.init=function(){t.render();var a=setInterval(t.trigger,t.interval);$(document).on("click",t.container+" #controls a",function(e){var i=$(this).attr("data-id");t.slide(i),clearInterval(a),a=setInterval(t.trigger,t.interval),e.preventDefault()})},this.trigger=function(){var a=$("div#slideshow #slides li.active");next=$(a).is(":last-child")?1:parseInt(a.attr("data-id"))+1,t.slide(next)},this.slide=function(a){$(t.container+" #slides li").animate({opacity:0},t.speed).removeClass("active"),$(t.container+" #slides li[ data-id = "+a+"]").animate({opacity:1},t.speed).addClass("active"),$(t.container+" #controls a").removeClass("active"),$(t.container+" #controls a[ data-id = "+a+"]").addClass("active")},this.render=function(){$.each(t.slides,function(a,e){state=0===a?"active":"inactive",r+="<li><a href=# data-id='"+e.ID+"' class='"+state+"'></a></li>",n+="<li data-id='"+e.ID+"' class='"+state+"'><div class='slide' style='background:url(\""+e.Image+"\")'></div><div class='text'><p class='emphasis_large'>"+e.Title+"</p><p class='emphasis_small'>"+e.Text+"</p><a href=# class='details'>Details</a></div></li>"}),$(t.container+" #controls").append(r),$(t.container+" #slides").append(n)},this.init()},carousel_obj=function(a,e,i,s,t,n){var r=this;this.container=a,this.data=e,this.num_rows=i,this.filter_key=s,this.filter_val=t,this.href=n,this.page=1,this.state="State",this.init=function(){r.render_handle(),r.control(),r.anchor()},this.control=function(){var a=r.data.length/r.num_rows;$(document).on("click",r.container+" #controls a",function(e){"next"===$(this).attr("data-func")?r.page<a&&(r.page++,r.render_handle("left")):r.page>1&&(r.page--,r.render_handle("right")),e.preventDefault()})},this.render_handle=function(a){start_key=(r.page-1)*r.num_rows,end_key=start_key+r.num_rows-1,$(r.container+" div#carousel .container").fadeOut().remove(),$.each(r.data,function(e,i){i[r.filter_key]===r.filter_val&&e>=start_key&&end_key>=e&&render_small_cards("div#carousel",r.href,i.ID,i.Image,i.Name,i.Price,i.Overview,i.Duration,a)})},this.anchor=function(){$(document).on("click",this.container+" #carousel a",function(a){$("main").children().fadeOut(function(){$(this).remove()});var e=$(this).attr("href"),i=(e.toLowerCase().replace(/\b[a-z]/g,function(a){return a.toUpperCase()}),$(this).prop("href"));window.history.pushState("","Title",baseURL+e);var s=$(this).attr("data-req");object_ID=$(this).attr("data-id"),handle(req_models[s],i,e,s,object_ID),a.preventDefault()})},this.init()};